<%= link_to "Back" , users_home_path,class:"backbtn"%>



  <h1 class="header">Add Personal Expense Here</h1>



  <style>
    .backbtn{
      height:100px;
      width:100px;

    }
    .header{
      font-size:2rem;
      font-family:cursive;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .form-container {
    display: flex;
    justify-content: center;
    align-items: center;
    
}

/* Target the form itself to control its size */
form {
    max-width: 500px; /* Adjust the max-width as needed to make the form smaller */
    width: 100%; /* This makes the form take the full width up to its max-width */
    margin: auto; /* This centers the form horizontally if it's smaller than the container */
    padding: 20px; /* Add some padding inside the form */
    box-shadow: 0 0 10px rgba(0,0,0,0.1); /* Optional: adds a subtle shadow around the form */
    background-color: #fff; /* Optional: sets a background color for the form */
    border-radius: 8px; /* Optional: rounds the corners of the form */
}
  body {
    font-family: Arial, sans-serif;
  }

  .field {
    margin-bottom: 15px;
  }

  label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
  }

  input[type="text"],
  input[type="datetime-local"],
  input[type="number"],
  select {
    width: 100%;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-bottom: 5px;
  }

  .form-group {
    background-color: #f4f4f4;
    padding: 15px;
    margin-bottom: 10px;
    border-radius: 5px;
  }

  #add-form-btn {
    background-color: #007bff;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    display: block;
    margin-top: 10px;
  }

  #add-form-btn:hover {
    background-color: #0056b3;
  }

  input[type="radio"] {
    margin-right: 5px;
  }

  input[type="submit"] {
    background-color: #28a745;
    color: white;
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    margin-top: 20px;
  }

  input[type="submit"]:hover {
    background-color: #218838;
  }
  /* Existing styles... */

.field {
    display: flex;
    flex-direction: column;
    margin-bottom: 15px;
}

/* New style for radio buttons */
.radio-buttons {
    flex-direction: row;
    align-items: center; /* To align items vertically center */
}

.label, .input, select {
    display: block;
    width: 100%;
    margin-bottom: 5px;
}
.remove-form-btn{

}
/* You may need to adjust the width or margins of the labels and inputs to fit your design */

  
</style>







<% if @type == 'personal_expense' %>
  <div class="form-container">
  <%# <%=  'form1' %>
  <%# this is starting of this form %>
  <%= form_tag "create_new_expense" do %>

    <%=hidden_field_tag "personnel_id", @personnel_id%>
    <div class="field radio-buttons">
      <%= label_tag(:income_or_expense, "Income or Expense:") %>
      <%= radio_button_tag(:income_or_expense, 'income') %>
      <%= label_tag(:income_or_expense_income, "Income") %>
      <%= radio_button_tag(:income_or_expense, 'expense') %>
      <%= label_tag(:income_or_expense_expense, "Expense") %>
    </div>

    <div class="field">
      <%= label_tag(:date_and_time, "Date and Time:") %>
      <%= datetime_field_tag(:date_and_time) %>
    </div>
    <div class="field">
      <%= label_tag(:category, "Category:") %>
      <%= select_tag(:category, options_for_select(["select category typeðŸ‘‡",'marketðŸ§º', 'onlineðŸ“±', 'travelâœˆï¸', 'occassionalðŸ«‚'])) %>
    </div>
    <div class="field">
      <%= label_tag(:payment_type, "Payment Type:") %>
      <%= select_tag(:payment_type, options_for_select(["select payment typeðŸ‘‡",'cashðŸ’°', 'onlineðŸ“±', 'cardðŸ’³', 'bank transferðŸ¦', 'chequeðŸ“‡'])) %>
    </div>
    <!--this is for new form-->

      <div id="forms-container">
        <div class="form-group" id="form-group-0">
          <%= label_tag 'field_one[0]', 'Item Name:' %>
          <%= text_field_tag 'field_one[]', nil, id: 'field_one_0' %>
          <%= label_tag 'field_two[0]', 'Amount:' %>
          <%= number_field_tag 'field_two[]', nil, id: 'field_two_0' %>     
        </div>
      </div>
      <%= button_tag 'Add Another Form', type: 'button', id: 'add-form-btn', class: 'btn btn-primary' %>

    <!--end of this form-->
    <div class="field">
      <%= label_tag(:remarks, "Remarks:") %>
      <%= text_field_tag(:remarks) %>
    </div>

    <%= submit_tag("Create Item") %>
  <% end %>
</div>





<% elsif @type == 'split_bill' %>
  <%=  'form3' %>
  <%# this is for split bill form %>
  <%= form_tag "create_new_expense" do %>
    
    <%=hidden_field_tag "personnel_id", @personnel_id%>
    <%# this is for select tag %>

    <div class="dropdown">
      <div id="dropdown-field" class="dropdown-field">Select a name</div>
      <div id="dropdown-list" class="dropdown-list" style="display:none;">
        <%= text_field_tag :search, nil, placeholder: "Search...", class: "search-box", id: "search-box" %>
        <% @users.each_with_index do |item, index| %>
          <div class="dropdown-item">
            <%= check_box_tag "items[]", item.name, false, id: "item#{index}" %>
            <%= label_tag "item#{index}", item.name %>
          </div>
        <% end %>

        <button id="select-all-btn">Select All</button>
      </div>
    </div>

    <%# end of select tag %>
    <div class="field">
      <%= label_tag(:date_and_time, "Date and Time:") %>
      <%= datetime_field_tag(:date_and_time) %>
    </div>

    <div class="field">
      <%= label_tag(:category, "Category:") %>
      <%= select_tag(:category, options_for_select(["select category typeðŸ‘‡",'marketðŸ§º', 'onlineðŸ“±', 'travelâœˆï¸', 'occassionalðŸ«‚'])) %>
    </div>

    <div class="field">
      <%= label_tag(:payment_type, "Payment Type:") %>
      <%= select_tag(:payment_type, options_for_select(["select payment typeðŸ‘‡",'cashðŸ’°', 'onlineðŸ“±', 'cardðŸ’³', 'bank transferðŸ¦', 'chequeðŸ“‡'])) %>
    </div>

    <!--this is for new form-->
      <div id="forms-container">
        <div class="form-group" id="form-group-0">
          <%= label_tag 'field_one[0]', 'Item Name:' %>
          <%= text_field_tag 'field_one[]', nil, id: 'field_one_0' %>
          <%= label_tag 'field_two[0]', 'Amount:' %>
          <%= number_field_tag 'field_two[]', nil, id: 'field_two_0' %> 
        </div>
      </div>
      <%= button_tag 'Add Another Form', type: 'button', id: 'add-form-btn', class: 'btn btn-primary' %>
    <!--end of this form-->
    <div class="field">
      <%= label_tag(:remarks, "Remarks:") %>
      <%= text_field_tag(:remarks) %>
    </div>
    <%= submit_tag("SPLIT_BILL") %>
  <% end %>
  <%# this is end of split bill  form %>








<% elsif @type == 'split_bill_person_wise' %>
  <%=  'form4' %>
  <%# this is form for last form %>
  <div class="formfour">
    <%= render 'expense/form_four' %>
  </div>
  <%# this is end form for last button%>
<% end %>





<script>

    let formCount = 1; // Start counting from 1 for the next form

    const addButton = document.getElementById('add-form-btn');
    const formsContainer = document.getElementById('forms-container');

    function addRemoveButton(formGroup, index) {
        const removeButton = document.createElement('button');
        removeButton.type = 'button';
        removeButton.textContent = 'Remove This Form';
        removeButton.className = 'remove-form-btn';
        removeButton.onclick = function() {
            formGroup.remove();
        };
        formGroup.appendChild(removeButton);
    }

    addButton.addEventListener('click', function() {
        const formGroup = document.createElement('div');
        formGroup.classList.add('form-group');
        formGroup.setAttribute('id', 'form-group-' + formCount);
        formGroup.innerHTML = `
            <label for="field_one_${formCount}">Item Name:${formCount}</label>
            <input type="text" id="field_one_${formCount}" name="field_one[]" />
            <label for="field_two_${formCount}">Amount:${formCount}</label>
            <input type="number" id="field_two_${formCount}" name="field_two[]" />
        `;
        formsContainer.appendChild(formGroup);
        addRemoveButton(formGroup, formCount);
        formCount++;
    });

    // this is code for select dropdown and set values
    document.addEventListener('DOMContentLoaded', function() {
        const dropdownField = document.getElementById('dropdown-field');
        const dropdownList = document.getElementById('dropdown-list');
        const searchBox = document.getElementById('search-box');
        const selectAllBtn = document.getElementById('select-all-btn');
    
        // Toggle dropdown list
        dropdownField.addEventListener('click', function() {
        dropdownList.style.display = dropdownList.style.display === 'none' ? 'block' : 'none';
        searchBox.value = ''; // Reset search box
        filterItems(''); // Reset filter
        });
    
        // Filter dropdown items
        searchBox.addEventListener('keyup', function() {
        filterItems(this.value);
        });
    
        // Function to filter items based on search
        function filterItems(query) {
        const items = dropdownList.getElementsByClassName('dropdown-item');
        for (let i = 0; i < items.length; i++) {
            let item = items[i];
            let text = item.textContent || item.innerText;
            item.style.display = text.toLowerCase().indexOf(query.toLowerCase()) > -1 ? "" : "none";
        }
        }
    
        // Hide dropdown list when clicking outside
        window.addEventListener('click', function(e) {
        if (!e.target.matches('.dropdown, .dropdown *')) {
            dropdownList.style.display = 'none';
        }
        });
    
        // Select item
        dropdownList.addEventListener('change', function(e) {
        if (e.target.type === 'checkbox') {
            let selectedItems = Array.from(dropdownList.querySelectorAll('input[type="checkbox"]:checked'))
            .map(checkbox => checkbox.value);
            dropdownField.textContent = selectedItems.join(', ');
        }
        });
    
        // Select all items
        selectAllBtn.addEventListener('click', function() {
        const checkboxes = dropdownList.querySelectorAll('input[type="checkbox"]');
        checkboxes.forEach(checkbox => checkbox.checked = true);
        let selectedItems = Array.from(checkboxes)
            .map(checkbox => checkbox.value);
        dropdownField.textContent = selectedItems.join(', ');
        
        });
        // deselect all element from checklist
          selectAllBtn.addEventListener('dblclick', function() {
          const checkboxes = dropdownList.querySelectorAll('input[type="checkbox"]');
          checkboxes.forEach(checkbox => checkbox.checked = false);
          dropdownField.textContent = 'Select a name';
          selectAllBtn.innerHTML = "Select All"
          });
      });
</script>
